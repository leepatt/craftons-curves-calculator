<!DOCTYPE html>
<html>
<head>
    <title>Test - Plywood Radius Curves</title>
    <style>
        .calculator-wrapper {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }
        .calculator-wrapper iframe {
            width: 100%;
            min-height: 800px;
            border: none;
        }
    </style>
</head>
<body>
    <div class="calculator-wrapper">
        <h1>Plywood Radius Curves</h1>
        <iframe 
            id="curves-calculator"
            src="http://localhost:3000"
            style="width: 100%; border: none;"
            allow="payment"
        ></iframe>
    </div>

    <script>
        // Simulate Shopify product context
        window.productContext = {
            productId: "test-plywood",
            productTitle: "Plywood Radius Curves",
            material: "CD-19"
        };

        // Handle product context requests from calculator iframe (same as Shopify implementation)
        window.addEventListener('message', function(event) {
            if (event.data && 
                event.data.type === 'PRODUCT_CONTEXT_REQUEST' && 
                event.data.source === 'craftons-curves-calculator') {
                
                console.log('üì• Received product context request from calculator iframe');
                
                // Send product context back to the iframe
                const iframe = document.getElementById('curves-calculator');
                if (iframe && iframe.contentWindow) {
                    try {
                        iframe.contentWindow.postMessage({
                            type: 'PRODUCT_CONTEXT_RESPONSE',
                            source: 'shopify-parent',
                            productContext: window.productContext
                        }, '*');
                        console.log('üì§ Sent product context to calculator iframe:', window.productContext);
                    } catch (error) {
                        console.warn('‚ùå Could not send product context to iframe:', error);
                    }
                }
            }
        }, false);

        // Handle iframe height adjustments
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'IFRAME_HEIGHT_CHANGE') {
                const iframe = document.getElementById('curves-calculator');
                if (iframe) {
                    iframe.style.height = `${event.data.height}px`;
                }
            }
        }, false);
    </script>
</body>
</html> 