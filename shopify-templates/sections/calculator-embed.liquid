{%- style -%}
  .calculator-wrapper {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }
  .calculator-wrapper iframe {
    width: 100%;
    min-height: 800px;
    border: none;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
{%- endstyle -%}

<div class="calculator-wrapper">
  <iframe 
    id="curves-calculator"
    src="{{ section.settings.calculator_url }}"
    style="width: 100%; border: none;"
    allow="payment"
  ></iframe>
</div>

<script>
  window.productContext = {
    productId: {{ product.id | json }},
    productTitle: {{ product.title | json }},
    material: {% case product.handle %}
      {% when 'craftons-radius-pro-formply' %}
        "form-17"
      {% when 'craftons-radius-pro-mdf' %}
        "mdf-18"
      {% when 'craftons-radius-pro-plywood' %}
        "CD-19"
      {% else %}
        "form-17"
    {% endcase %}
  };

  // Handle iframe height adjustments
  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'IFRAME_HEIGHT_CHANGE') {
      const iframe = document.getElementById('curves-calculator');
      if (iframe) {
        iframe.style.height = `${event.data.height}px`;
      }
    }
  }, false);
</script>

{% schema %}
{
  "name": "Curves Calculator",
  "settings": [
    {
      "type": "text",
      "id": "calculator_url",
      "label": "Calculator URL",
      "default": "https://your-calculator-url.com"
    }
  ],
  "presets": [
    {
      "name": "Curves Calculator",
      "category": "Custom"
    }
  ]
}
{% endschema %} 